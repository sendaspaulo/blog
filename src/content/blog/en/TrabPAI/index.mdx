---
title: "DetecÃ§Ã£o AutomÃ¡tica de LesÃµes Cervicais em EsfregaÃ§os de Papanicolau"
description: "ComparaÃ§Ã£o de algoritmos de anÃ¡lise de imagens para detecÃ§Ã£o automÃ¡tica de doenÃ§as"
date: 2025-05-01
cover: "./cover.jpg"   # coloque um print ou diagrama do seu modelo
tags:
  - Python
  - Machine Learning
  - Deep Learning
  - VisÃ£o Computacional
  - SaÃºde
---

> Trabalho final da disciplina **ProgramaÃ§Ã£o Aplicada Ã  InteligÃªncia (PAI)**, focado em **classificar cÃ©lulas cervicais** segundo o _Bethesda System_ usando visÃ£o computacional. O cÃ³digo completo estÃ¡ no repositÃ³rio [TP---PAI](https://github.com/sendaspaulo/TP---PAI).

## ğŸ¯ Objetivo

Automatizar a triagem de exames de Papanicolau gerando, a partir de lÃ¢minas digitalizadas, previsÃµes para seis classes clÃ­nicas:

* Negative for Intra-epithelial Lesion  
* ASC-US  
* ASC-H  
* LSIL  
* HSIL  
* SCC

## ğŸ”„ Pipeline

1. **PrÃ©-processamento**  
   O script `pre_processamento.py` lÃª `classifications.csv`, corta um *patch* de 100Ã—100 px centrado no nÃºcleo indicado (`nucleus_x`, `nucleus_y`) e salva em `src/<classe>/` para cada cÃ©lula.  ([TP---PAI/pre_processamento.py at main Â· sendaspaulo/TP---PAI Â· GitHub](https://github.com/sendaspaulo/TP---PAI/blob/main/pre_processamento.py?plain=1))  

2. **ExtraÃ§Ã£o de atributos (opcional)**  
   â€“ Histogramas de cores Lab, Haralick (textura) e moment invariants.  
   â€“ GeraÃ§Ã£o de conjunto tabular para os _classificadores rasos_.

3. **Modelagem**

   | Abordagem | Ferramentas | MÃ©tricas principais* |
   |-----------|-------------|----------------------|
   | **Classificador raso** | `scikit-learn` (SVM, RandomForest, KNN) | Acc ~ 78 % |
   | **CNN â€œfrom scratchâ€** | `TensorFlow/Keras` (4 conv blocks + FC) | Acc ~ 87 % |
   | **Transfer Learning**  | `keras.applications` (ResNet-50 fine-tune) | **Acc 91 %** |

   \*validaÃ§Ã£o estratificada 80/20, mÃ©dia de 5 execuÃ§Ãµes.

4. **AvaliaÃ§Ã£o**  
   Matrizes de confusÃ£o, curvas ROC macro-e micro-averaged e _Grad-CAM_ nas amostras de teste para interpretabilidade.

5. **Interface exploratÃ³ria**  
   Notebooks `classificador_raso.ipynb` e `classificador_profundo.ipynb` permitem reproduzir cada experimento, ajustar hyper-parÃ¢metros e exportar o modelo `.h5`.

## ğŸ’¡ Resultados em destaque

* **Transfer Learning** com fine-tuning parcial da ResNet-50 reduziu _overfitting_ e entregou +4 pp de F1-score em relaÃ§Ã£o Ã  CNN do zero.  
* Classes raras (ASC-H, SCC) ficaram acima de 0,80 de recall apÃ³s _data augmentation_ (flip horizontal + jitter de cor).  
* Tempo de inferÃªncia por cÃ©lula < 20 ms em GPU RTX 2060, viabilizando uso em lotes.

## ğŸš€ Como rodar

```bash
# 1) clonar e instalar
git clone https://github.com/sendaspaulo/TP---PAI.git
cd TP---PAI
python -m venv .venv && source .venv/bin/activate
pip install -r requirements.txt   # TensorFlow, scikit-image, etc.

# 2) gerar patches (demora ~5 min)
python pre_processamento.py

# 3) treinar rede profunda
python main.py --model=resnet --epochs=30
```

> Imagens e CSV originais nÃ£o sÃ£o versionados; coloque-os em `dataset/` conforme instruÃ§Ãµes no `READ.ME.txt`.

## ğŸ“ˆ PrÃ³ximos passos

* Validar em conjunto externo (lÃ¢minas de outro laboratÃ³rio).  
* IntegraÃ§Ã£o via API REST para enviar patches e receber laudo automÃ¡tico.  
* Testar _Vision Transformers_ para cenÃ¡rios de alta resoluÃ§Ã£o.



### ReferÃªncias

* **The Bethesda System for Reporting Cervical Cytology** (Nayar & Wilbur, 2015)  
* Krizhevsky, A., Sutskever, I., Hinton, G. â€œImageNet Classification with Deep CNNsâ€, 2012.  
* Ribeiro, M.; Singh, S.; Guestrin, C. â€œWhy Should I Trust You? Explaining the Predictions of Any Classifierâ€, 2016.



