---
title: "Expected Goals (xG) em Futebol â€“ Modelagem com Dados StatsBomb"
description: "Estimativa de probabilidade de gol a partir de eventos de jogo e comparaÃ§Ã£o de modelos de machine learning"
date: 2025-05-05
cover: "./xg.png"   # substitua por um print do heat-map de xG ou diagrama do fluxo
tags:
  - Python
  - Machine Learning
  - Sports Analytics
  - Football
  - Data Science
  - VisÃ£o Computacional
---

> Projeto de **analytics esportivo** desenvolvido para o portfÃ³lio pessoal, demonstrando a construÃ§Ã£o de um modelo de *Expected Goals* com o pacote **statsbombpy** e validaÃ§Ã£o em jogos das cinco grandes ligas europeias (2015-2016). CÃ³digo completo no repositÃ³rio [xG-StatsBomb-Analysis](https://github.com/sendaspaulo/xG-StatsBomb-Analysis).

## ðŸŽ¯ Objetivo

Quantificar a probabilidade de um chute resultar em gol (*xG*) com base em variÃ¡veis geomÃ©tricas e contextuais extraÃ­das dos eventos da StatsBomb, oferecendo um pipeline reprodutÃ­vel da coleta ao deploy do modelo.

## ðŸ”„ Pipeline

1. **Coleta & Limpeza**  
   `data_ingest.py` baixa partidas via *statsbombpy*, normaliza colunas, remove eventos sem coordenadas e gera `events.parquet`.

2. **Feature Engineering**  
   * DistÃ¢ncia e Ã¢ngulo do chute ao centro do gol.  
   * SituaÃ§Ã£o da jogada (bola rolando, pÃªnalti, falta, cabeceio).  
   * PosiÃ§Ã£o do goleiro adversÃ¡rio (quando disponÃ­vel).  
   * Minuto da partida e diferenÃ§a de placar.

3. **Modelagem**

   | Modelo | Ferramentas | AUC ROC* | Log-loss* |
   |--------|-------------|----------|-----------|
   | **RegressÃ£o LogÃ­stica** | scikit-learn | 0,73 | 0,38 |
   | **Random Forest** | scikit-learn | 0,79 | 0,34 |
   | **XGBoost** | xgboost | **0,82** | **0,31** |

   \* validaÃ§Ã£o estratificada 70/30, mÃ©dia de 3 execuÃ§Ãµes.

4. **AvaliaÃ§Ã£o Visual**  
   Heat-maps de xG por zona do campo, curvas ROC e *calibration plots* para cada modelo, alÃ©m de tabelas de importÃ¢ncia de variÃ¡veis (SHAP).

5. **ExportaÃ§Ã£o & Deploy**  
   `export_model.py` grava artefato `.json` (XGBoost Booster) e gera endpoint Flask em `app.py`, pronto para uso via REST.

## ðŸ’¡ Resultados em Destaque

* XGBoost superou modelos lineares em +9 pp de AUC, capturando interaÃ§Ãµes nÃ£o lineares entre Ã¢ngulo e distÃ¢ncia.  
* Jogadas de cabeÃ§a apresentaram xG 43 % menor, mesmo a curta distÃ¢ncia, confirmando estudos prÃ©vios sobre dificuldade de cabeceios.  
* Mapa de calor evidencia â€œgolden zoneâ€ retangular (largura da pequena Ã¡rea atÃ© o pÃªnalti) com xG > 0,30 por tentativa.

## ðŸš€ Como Rodar

```bash
# 1) clonar e instalar dependÃªncias
git clone https://github.com/sendaspaulo/xG
cd xG-StatsBomb-Analysis
python -m venv .venv && source .venv/bin/activate
pip install -r requirements.txt   # statsbombpy, xgboost, shap...

# 2) baixar dados e preparar parquet (~2 min)
python data_ingest.py

# 3) treinar modelo XGBoost
python train.py --model xgb --epochs 100

# 4) iniciar API de prediÃ§Ã£o
python app.py        # localhost:5000/predict
